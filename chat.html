<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no" />
  <title>Chat - Animated Modern</title>
  <style>
    /* Reset and basics */
    * {
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: #222;
      margin: 0;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      overflow: hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* Container for app */
    #app-container {
      width: 100%;
      max-width: 360px;
      height: 600px;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 15px 25px rgba(0,0,0,0.3);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      position: relative;
    }

    /* Popup Terms of Service */
    #tos-popup {
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      background: #fff;
      border-radius: 20px;
      padding: 30px 20px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      box-shadow: inset 0 0 30px rgba(0,0,0,0.1);
      animation: fadeDownIn 0.6s ease forwards;
      text-align: center;
      z-index: 10;
    }
    #tos-popup a {
      color: #667eea;
      text-decoration: none;
      font-weight: 600;
      transition: color 0.3s ease;
    }
    #tos-popup a:hover {
      color: #764ba2;
      text-decoration: underline;
    }
    #tos-popup p {
      font-size: 1.1rem;
      margin-bottom: 25px;
      line-height: 1.4;
      user-select: none;
    }
    #tos-popup button {
      margin: 8px;
      padding: 12px 26px;
      border: none;
      border-radius: 50px;
      font-weight: 700;
      cursor: pointer;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      box-shadow: 0 4px 15px rgba(102,126,234,0.6);
      transition: transform 0.25s ease, box-shadow 0.3s ease;
      user-select: none;
      width: 160px;
      font-size: 1rem;
    }
    #tos-popup button:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 18px rgba(118,75,162,0.8);
    }
    #tos-popup button:active {
      transform: scale(0.95);
    }

    /* Main interface container hidden initially */
    #main-interface {
      flex: 1;
      padding: 20px 20px 30px;
      display: flex;
      flex-direction: column;
      opacity: 0;
      pointer-events: none;
      animation: fadeIn 0.6s ease forwards 0.3s;
    }
    #main-interface.visible {
      opacity: 1;
      pointer-events: auto;
    }

    /* Heading */
    #main-interface h2 {
      margin: 0 0 15px 0;
      font-weight: 700;
      font-size: 1.6rem;
      color: #444;
      user-select: none;
      text-align: center;
    }

    /* Input section */
    .input-section {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-bottom: 20px;
      animation: slideInUp 0.5s ease forwards;
    }

    .input-section input {
      flex-grow: 1;
      max-width: 190px;
      padding: 12px 14px;
      font-size: 1rem;
      border-radius: 50px;
      border: 2px solid #dedede;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
      user-select: text;
    }
    .input-section input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 6px rgba(102,126,234,0.6);
      background: #fff;
    }

    .input-section button {
      background: linear-gradient(135deg, #667eea, #764ba2);
      border: none;
      border-radius: 50px;
      color: white;
      font-size: 1rem;
      font-weight: 600;
      padding: 12px 22px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(102,126,234,0.7);
      transition: transform 0.3s ease, box-shadow 0.4s ease;
      user-select: none;
      flex-shrink: 0;
    }
    .input-section button:hover {
      transform: translateY(-3px);
      box-shadow: 0 7px 20px rgba(118,75,162,0.9);
    }
    .input-section button:active {
      transform: translateY(1px);
    }

    /* Chat interface hidden by default */
    #chat-interface {
      flex: 1;
      display: none;
      flex-direction: column;
      animation: fadeIn 0.6s ease forwards;
    }
    #chat-interface.visible {
      display: flex;
    }

    /* User ID and controls row */
    #chat-interface > p {
      font-size: 0.85rem;
      user-select: none;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      margin: 0 0 15px;
      font-weight: 600;
      color: #555;
    }
    #chat-interface > p button {
      padding: 6px 12px;
      font-size: .85rem;
      border-radius: 20px;
      border: none;
      background: #667eea88;
      color: white;
      cursor: pointer;
      transition: background-color 0.25s ease, transform 0.2s ease;
      user-select: none;
      flex-shrink: 0;
    }
    #chat-interface > p button:hover {
      background: #764ba2cc;
      transform: translateY(-2px);
    }
    #chat-interface > p button:active {
      transform: translateY(1px);
    }

    /* Friend ID connection section */
    #chat-interface input#friend-id {
      width: 100%;
      padding: 12px 14px;
      border-radius: 50px;
      border: 2px solid #dedede;
      font-size: 1rem;
      margin-bottom: 10px;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
      user-select: text;
    }
    #chat-interface input#friend-id:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 8px rgba(102,126,234,0.7);
    }
    #chat-interface button.connect-btn {
      background: linear-gradient(135deg, #667eea, #764ba2);
      border: none;
      border-radius: 50px;
      color: white;
      width: 100%;
      font-weight: 600;
      font-size: 1.1rem;
      padding: 12px 0;
      cursor: pointer;
      box-shadow: 0 4px 16px rgba(102,126,234,0.8);
      transition: filter 0.3s ease, transform 0.25s ease;
      user-select: none;
      margin-bottom: 15px;
    }
    #chat-interface button.connect-btn:hover {
      filter: brightness(1.1);
      transform: translateY(-3px);
    }
    #chat-interface button.connect-btn:active {
      transform: translateY(1px);
    }

    /* Video container */
    .video-container {
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: nowrap;
      margin-bottom: 10px;
      user-select: none;
    }
    .video-container video {
      width: 160px;
      height: 120px;
      border-radius: 15px;
      background: black;
      box-shadow: 0 6px 18px rgba(102,126,234,0.4);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
      object-fit: cover;
    }
    .video-container video:hover {
      transform: scale(1.1) rotateZ(2deg);
      box-shadow: 0 10px 30px rgba(118,75,162,0.7);
      z-index: 5;
    }

    /* Call controls */
    .controls {
      display: flex;
      justify-content: space-around;
      margin-bottom: 12px;
      user-select: none;
    }
    .controls button {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      border: none;
      border-radius: 50px;
      padding: 10px 15px;
      font-weight: 700;
      font-size: 1rem;
      cursor: pointer;
      box-shadow: 0 6px 18px rgba(102,126,234,0.6);
      transition: transform 0.25s ease, box-shadow 0.35s ease;
      flex: 1;
      margin: 0 6px;
    }
    .controls button:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(118,75,162,0.8);
    }
    .controls button:active {
      transform: translateY(1px);
    }

    /* Chat box and message input */
    .chat-box {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      user-select: none;
    }
    .chat-box input#message-input {
      width: 100%;
      padding: 12px 16px;
      font-size: 1rem;
      border-radius: 50px;
      border: 2px solid #dedede;
      margin-bottom: 10px;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
      user-select: text;
    }
    .chat-box input#message-input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 8px rgba(102,126,234,0.7);
    }
    .chat-box button {
      background: linear-gradient(135deg, #667eea, #764ba2);
      border: none;
      border-radius: 50px;
      color: white;
      font-weight: 600;
      font-size: 1.1rem;
      padding: 12px 0;
      width: 100%;
      cursor: pointer;
      box-shadow: 0 4px 16px rgba(102,126,234,0.7);
      transition: filter 0.3s ease, transform 0.25s ease;
      user-select: none;
      margin-bottom: 10px;
    }
    .chat-box button:hover {
      filter: brightness(1.15);
      transform: translateY(-3px);
    }
    .chat-box button:active {
      transform: translateY(1px);
    }

    /* Messages container */
    #messages {
      flex-grow: 1;
      width: 100%;
      background: #f5f6fa;
      padding: 12px 15px;
      border-radius: 15px;
      box-shadow: inset 0 0 12px rgba(0,0,0,0.05);
      overflow-y: auto;
      font-size: 0.95rem;
      color: #333;
      scrollbar-width: thin;
      scrollbar-color: #667eea transparent;
      user-select: text;
    }
    /* Custom scrollbar for WebKit */
    #messages::-webkit-scrollbar {
      width: 8px;
    }
    #messages::-webkit-scrollbar-track {
      background: transparent;
    }
    #messages::-webkit-scrollbar-thumb {
      background-color: #667eea;
      border-radius: 20px;
      border: 2px solid transparent;
      background-clip: content-box;
    }
    /* Individual message styling */
    #messages div {
      background: white;
      margin-bottom: 8px;
      padding: 10px 14px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      max-width: 80%;
      opacity: 0;
      transform: translateX(50px);
      animation: slideFadeIn 0.5s forwards;
      word-wrap: break-word;
    }
    #messages div:nth-child(odd) {
      background: #e0d7f8;
      align-self: flex-start;
    }
    #messages div:nth-child(even) {
      background: #a293f7;
      color: white;
      align-self: flex-end;
    }

    /* Animations */
    @keyframes slideFadeIn {
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
    @keyframes fadeDownIn {
      from {
        opacity: 0;
        transform: translateY(-30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }
    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Responsive for small mobile */
    @media (max-width: 375px) {
      #app-container {
        max-width: 100%;
        height: 100vh;
        border-radius: 0;
      }
      .video-container video {
        width: 140px;
        height: 105px;
      }
      .input-section {
        flex-direction: column;
        gap: 12px;
      }
      .input-section input,
      .input-section button,
      #chat-interface button.connect-btn,
      .chat-box button {
        width: 100%;
      }
      .controls {
        flex-direction: column;
      }
      .controls button {
        margin: 6px 0;
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div id="app-container">
    <div id="tos-popup" class="popup">
      <p>Please read and agree to our<br/>
        <a href="https://technosaqib.github.io/chat(terms-of-service).txt" target="_blank" rel="noreferrer noopener">Terms of Service</a> and<br/>
        <a href="https://technosaqib.github.io/chat(privacy-policy).txt" target="_blank" rel="noreferrer noopener">Privacy Policy</a><br/>
        before using this website.
      </p>
      <button onclick="agreeTOS()">I Agree</button>
      <button onclick="disagreeTOS()">I Disagree</button>
    </div>

    <div id="main-interface" aria-live="polite" aria-atomic="true">
      <h2>Welcome to Chat!</h2>

      <div class="input-section" id="input-section">
        <input type="text" id="username" placeholder="Enter your name" autocomplete="name" aria-label="Enter your name" />
        <button onclick="registerUser()">Start</button>
      </div>

      <div id="chat-interface" aria-live="polite" aria-atomic="false" aria-relevant="additions" role="region" style="display: none;">
        <p>Your ID: <span id="my-id" aria-live="polite" aria-atomic="true"></span>
          <button onclick="copyID()" aria-label="Copy your ID to clipboard">Copy</button>
          <button onclick="shareID()" aria-label="Share your ID">Share</button>
        </p>

        <input type="text" id="friend-id" placeholder="Enter friend's ID" autocomplete="off" aria-label="Friend's ID to connect" />
        <button class="connect-btn" onclick="connect()">Connect</button>

        <div class="video-container" aria-label="Video call streams" role="region">
          <video id="local-video" autoplay muted playsinline></video>
          <video id="remote-video" autoplay playsinline></video>
        </div>

        <div class="controls">
          <button onclick="startVoiceCall()" aria-label="Start voice call">Voice Call</button>
          <button onclick="startVideoCall()" aria-label="Start video call">Video Call</button>
          <button onclick="stopCall()" aria-label="Stop current call">Stop Call</button>
        </div>

        <div class="chat-box">
          <input type="text" id="message-input" placeholder="Type message..." autocomplete="off" aria-label="Message input" />
          <button onclick="sendMessage()">Send</button>
          <div id="messages" aria-live="polite" aria-atomic="false" aria-relevant="additions"></div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/peerjs@1.4.7/dist/peerjs.min.js"></script>
  <script>
  // JavaScript code with animations
  let peer, conn, localStream, currentCall;

  function agreeTOS() {
    const tosPopup = document.getElementById("tos-popup");
    const mainIntf = document.getElementById("main-interface");
    // Animate hide popup
    tosPopup.style.animation = 'fadeDownOut 0.5s ease forwards';
    tosPopup.addEventListener('animationend', () => {
      tosPopup.style.display = "none";
      mainIntf.classList.add('visible');
    }, { once: true });
  }

  function disagreeTOS() {
    window.location.href = "https://google.com";
  }

  function generateID(name) {
    return name.toLowerCase().replace(/\s/g, "");
  }

  function registerUser() {
    const name = document.getElementById("username").value.trim();
    if (!name) {
      alert("Enter a name!");
      return;
    }

    const userId = generateID(name);
    peer = new Peer(userId);

    peer.on('open', id => {
      document.getElementById("my-id").innerText = id;
      document.getElementById("chat-interface").style.display = "flex";

      peer.on('connection', incoming => {
        conn = incoming;
        showMessage("Info", "Connected with friend!");
        conn.on('data', msg => showMessage("Friend", msg));
      });

      peer.on('call', call => {
        navigator.mediaDevices.getUserMedia({ video: true, audio: true })
          .then(stream => {
            localStream = stream;
            currentCall = call;
            call.answer(stream);
            call.on('stream', remote => {
              document.getElementById("remote-video").srcObject = remote;
              document.getElementById("local-video").srcObject = stream;
            });
          }).catch(e => alert("Error accessing media devices: " + e.message));
      });
    });

    peer.on('error', err => alert("PeerJS error: " + err));
  }

  function connect() {
    const friendId = document.getElementById("friend-id").value.trim();
    if (!friendId) {
      alert("Enter your friend's ID!");
      return;
    }
    conn = peer.connect(friendId);
    conn.on('open', () => {
      showMessage("Info", "Connected to friend.");
      conn.on('data', msg => showMessage("Friend", msg));
    });
    conn.on('error', err => alert("Connection error: " + err));
  }

  function sendMessage() {
    const input = document.getElementById("message-input");
    const msg = input.value.trim();
    if (!msg) return;
    if (!conn) {
      alert("Not connected to anyone.");
      return;
    }

    conn.send(msg);
    showMessage("Me", msg);
    input.value = "";
  }

  function showMessage(sender, msg) {
    const messagesEl = document.getElementById("messages");
    const div = document.createElement("div");
    div.textContent = `${sender}: ${msg}`;
    div.style.opacity = 0;
    messagesEl.appendChild(div);
    // Animate with slideFadeIn
    setTimeout(() => {
      div.style.opacity = 1;
      div.style.transform = "translateX(0)";
      div.style.animation = "slideFadeIn 0.5s forwards";
    }, 50);
    messagesEl.scrollTop = messagesEl.scrollHeight;
  }

  function copyID() {
    const id = document.getElementById("my-id").innerText;
    navigator.clipboard.writeText(id).then(() => alert("Copied!"));
  }

  function shareID() {
    const id = document.getElementById("my-id").innerText;
    const shareText = `Hey, connect with me on Chat! My ID is: ${id}`;
    if (navigator.share) {
      navigator.share({ title: "Chat ID", text: shareText });
    } else {
      alert("Sharing not supported. Copy the ID manually.");
    }
  }

  function startVoiceCall() {
    callPeer(false);
  }

  function startVideoCall() {
    callPeer(true);
  }

  function callPeer(videoEnabled) {
    const friendId = document.getElementById("friend-id").value.trim();
    if (!friendId) {
      alert("Enter friend's ID!");
      return;
    }

    navigator.mediaDevices.getUserMedia({ video: videoEnabled, audio: true })
      .then(stream => {
        localStream = stream;
        document.getElementById("local-video").srcObject = stream;

        const call = peer.call(friendId, stream);
        currentCall = call;

        call.on('stream', remote => {
          document.getElementById("remote-video").srcObject = remote;
        });
      }).catch(e => alert("Error accessing media devices: " + e.message));
  }

  function stopCall() {
    if (localStream) {
      localStream.getTracks().forEach(track => track.stop());
    }
    if (currentCall) currentCall.close();
    document.getElementById("local-video").srcObject = null;
    document.getElementById("remote-video").srcObject = null;
  }
  </script>

  <style>
    @keyframes fadeDownOut {
      to {
        opacity: 0;
        transform: translateY(30px);
      }
    }
  </style>
</body>
</html>
</content>
</create_file>
